---
layout: post
title: Let Function
description: How to write readable excel formulas
summary: published on 21 Apr 2021
tags: [Tech, Rumination]
---

1. You can find this in here in the [Tweet Thread](https://twitter.com/shwinkc/status/1386137089440374786)



2. **Excel formulas are hard to read**. <br>  For example, Its hard to tell how
    `(MIN(MOD(A1,SEQUENCE(SQRT(A1),,2,1)))<>0)` checks if value in *A1* is a prime number.
    <br> With **LET** function, this formulas can be composed legibly.
    

2.  I'll clarify 3 points before we begin. <br><br> First, **Prime number** is an integer greater than one which is only divisible by itself and 1. Put another way, the remainder of dividing a prime number by any integer other other than 1 is never equal to 0. <br><br>


3. Second **Primality test** is an algorithm to determine if a given number is prime. The algorithm for a given number, $$n$$, is to check if it is evenly divisible by any number between $$2$$ and $$\sqrt n$$. <br> If yes, then n is non-prime. Else, it is prime.

4.  Finally, **LET** function assigns names to calculation results. <br> The picture explains it best.
        ![LetFunc](https://support.content.office.net/en-us/media/492526a6-54ec-4c18-8800-38bec7600ff6.png "Source: support.microsoft.com/")
    

5. Primality test for a number $$n$$ follows below sequence.
    
    <br><br> **1**, calculate $$\sqrt n$$.
    <br> **2**, create an integer array $${2...\sqrt n$$
    <br> **3**, divide $$n$$ by array $${2...\sqrt n$$ to create new *array of remainders*
    <br> **4**, check if minimum value in the *array of remainders* is $$0$$
    <br> **5**, if *No*, then $$n$$ is prime.

6. `(MIN(MOD(A1,SEQUENCE(SQRT(A1),,2,1)))<>0)` implements these steps except that its hard to see how.

7. **LET** function is more intuitive in following the sequence of steps.
    <br> Here's the formula
    ```
    =LET(
    S0_,A1,
    S1_,SQRT(S0_),
    S2_,SEQUENCE(S1_,,2,1),
    S3_,MOD(S0_,S2_),
    S4_,MIN(S3_),
    S5_,(S4_<>0),
    S5
    )
    ```

8. Here's how to read the formula 
    <br><br>`S0_,A1,` <br>
        -- `S1_` is the value in `A1`
    <br><br>`S1_,SQRT(S0_)` <br>
        -- `S1_` equals square root of `S0_`
    <br><br>`S2_,SEQUENCE(S1_,,2,1),` <br>
        -- `S2_` is the *array of integers* from $$2$$ to `S1_` with increment of $$1$$
    <br><br>`S3_,MOD(S0_,S2_),` <br>
        -- `S3_` is the *array of remainders* resulting from `S0_`/`S2_`
    <br><br>`S4_,MIN(S3_),` <br>
        -- `S4_` is the minimum value in `S3_`, i.e. *array of remainders*
    <br><br>`S5_,(S4_<>0),` <br>
        -- `S5_` is check of equality if `S4_` is not $$0$$

9. **LET** function is more legible and improves Excel calculation speed. However, nested formula are easier to compose. The best practice might be to compose nested formulas and then convert those to **LET** functions.

10. You can download the [Demo File Here](https://github.com/continuoous/Spreadsheets/blob/main/Let.xlsx?raw=true)