---
layout: post
title: Let Function
description: How to write readable excel formulas
summary: published on 21 Apr 2021
tags: [Tech, Rumination]
---

1. Excel formulas are hard to read. <br> The formula below checks if value in *A1* is a prime number. <br> But its hard to tell how it works.
    ```
    =(MIN(MOD(A1,SEQUENCE(SQRT(A1),,2,1)))<>0)
    ```
After you get a hang of **LET** function, this formulas can be composed legibly. <br> I'll clarify 2 points before we see how.
    

2.  What is a **prime number** and **primality test**? <br><br> **Prime number** is an integer greater than one which is only divisible by itself and 1. Put another way, the remainder of dividing a prime number by any integer other other than 1 is never equal to 0. <br><br>
**Primality test** is how we determine if an input number is prime. <br> The algorithm for a given an input number, $$n$$, is to check if it is evenly divisible by any number between $$2$$ and $$\sqrt n$$ (i.e. that the division leaves no remainder). <br> If yes, then n is non-prime. Else, it is prime.

3.  What is **LET** function? <br> The LET function assigns names to calculation results. <br> The picture explains it best.
        ![LetFunc](https://support.content.office.net/en-us/media/492526a6-54ec-4c18-8800-38bec7600ff6.png "Source: support.microsoft.com/")
    

4. `(MIN(MOD(A1,SEQUENCE(SQRT(A1),,2,1)))<>0)` implements primality test with below sequence of steps.
    <br><br> For the value in cell *A1*, lets say $$n$$
    <br> **Step1**, it calculates square root, $$\sqrt n$$.
    <br> **Step2**, it create an *array of integers* from $$2$$ to $$\sqrt n$$
    <br> **Step3**, it divides $$n$$ by the *array of integers* and create a new *array of remainders*
    <br> **Step4**, it checks if the minimum value in the *array of remainders* is $$0$$
    <br> **Step5**, if yes, then the number is non-prime. Else, it is prime.

5. **LET** function is more intuitive in following the sequence of steps.
    <br> Here's the formula
    ```
    =LET(
    S0_,A1,
    S1_,SQRT(S0_),
    S2_,SEQUENCE(S1_,,2,1),
    S3_,MOD(S0_,S2_),
    S4_,MIN(S3_),
    S5_,(S4_<>0),
    S5
    )
    ```

6. Here's how to read the formula 
    <br><br>`S0_,A1,` <br>
        -- `S1_` is the value in `A1`
    <br><br>`S1_,SQRT(S0_)` <br>
        -- `S1_` equals square root of `S0_`
    <br><br>`S2_,SEQUENCE(S1_,,2,1),` <br>
        -- `S2_` is the *array of integers* from $$2$$ to `S1_` with increment of $$1$$
    <br><br>`S3_,MOD(S0_,S2_),` <br>
        -- `S3_` is the *array of remainders* resulting from `S0_`/`S2_`
    <br><br>`S4_,MIN(S3_),` <br>
        -- `S4_` is the minimum value in `S3_`, i.e. *array of remainders*
    <br><br>`S5_,(S4_<>0),` <br>
        -- `S5_` is check of equality if `S4_` is not $$0$$

7. **LET** function is more legible and improves Excel calculation speed. However, nested formula are easier to compose. The best practice might be to compose nested formulas and then convert those to **LET** functions.

8. You can download the [Demo File Here](https://github.com/continuoous/Spreadsheets/blob/main/Let.xlsx?raw=true)